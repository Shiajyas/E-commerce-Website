<%- include("../partials/header") %>

<head>
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

</head>


<style>
    .swiper-container {
        width: 100%;
        height: 100%;
    }
    .swiper-slide {
        text-align: center;
        font-size: 18px;
        background: #fff;

        /* Center slide text vertically */
        display: -webkit-box;
        display: -ms-flexbox;
        display: -webkit-flex;
        display: flex;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        -webkit-justify-content: center;
        justify-content: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        -webkit-align-items: center;
        align-items: center;
    }
    .swiper-button-next,
    .swiper-button-prev {
        color: #fff;
    }
</style>


<style>
    .home-slider {
        overflow: hidden; /* Hide any content that overflows the container */
    }

    .swiper-container {
        max-width: 100%; /* Limit the maximum width to 100% of the parent container */
        overflow: hidden; /* Hide any content that overflows the container */
    }

    .swiper-wrapper {
        display: flex; /* Ensure the wrapper items are displayed in a row */
    }

    .swiper-slide {
        width: 100%; /* Make each slide take up the full width of the container */
        box-sizing: border-box; /* Include padding and border in the element's total width and height */
    }
</style>


   <section class="home-slider position-relative pt-70 pb-50">
  <div class="swiper">
    <div class="swiper-wrapper">
      <% for (let i = 0; i < banner.length; i++) { %>
        <div class="swiper-slide">
          <img
            src="/uploads/product-images/<%= banner[i].image %>"
            style="width:100%; height:auto"
          />
        </div>
      <% } %>
    </div>

    <div class="swiper-pagination"></div>
    <div class="swiper-button-next"></div>
    <div class="swiper-button-prev"></div>
  </div>
</section>


  <section class="container py-5">
    <div class="text-center mb-5">
        <h2 class="fw-bold">Why Shop With <span class="text-primary">Think Thanks</span></h2>
        <p class="text-muted mt-2">
            Smart shopping made simple, reliable, and affordable.
        </p>
    </div>

    <div class="row g-4">
        <!-- Feature 1 -->
        <div class="col-md-3 col-sm-6">
            <div class="p-4 h-100 border rounded text-center shadow-sm">
                <i class="fi-rs-shield-check fs-1 text-primary mb-3"></i>
                <h5 class="fw-semibold">Trusted Quality</h5>
                <p class="text-muted small">
                    Every product is carefully verified to ensure premium quality.
                </p>
            </div>
        </div>

        <!-- Feature 2 -->
        <div class="col-md-3 col-sm-6">
            <div class="p-4 h-100 border rounded text-center shadow-sm">
                <i class="fi-rs-truck fs-1 text-primary mb-3"></i>
                <h5 class="fw-semibold">Fast Delivery</h5>
                <p class="text-muted small">
                    Quick, safe, and reliable shipping right to your doorstep.
                </p>
            </div>
        </div>

        <!-- Feature 3 -->
        <div class="col-md-3 col-sm-6">
            <div class="p-4 h-100 border rounded text-center shadow-sm">
                <i class="fi-rs-wallet fs-1 text-primary mb-3"></i>
                <h5 class="fw-semibold">Best Prices</h5>
                <p class="text-muted small">
                    Competitive pricing without compromising on quality.
                </p>
            </div>
        </div>

        <!-- Feature 4 -->
        <div class="col-md-3 col-sm-6">
            <div class="p-4 h-100 border rounded text-center shadow-sm">
                <i class="fi-rs-refresh fs-1 text-primary mb-3"></i>
                <h5 class="fw-semibold">Easy Returns</h5>
                <p class="text-muted small">
                    Hassle-free returns and customer-first support.
                </p>
            </div>
        </div>
    </div>
</section>



       

        <section class="product-tabs section-padding position-relative wow fadeIn animated">
            <div class="bg-square"></div>
               <div class="container">
                <h3 class="section-title mb-20 wow fadeIn animated"><span>Featured</span> Products</h3>
                <div class="carausel-6-columns-cover position-relative wow fadeIn animated">
                    <div class="slider-arrow slider-arrow-2 carausel-6-columns-arrow" id="carausel-6-columns-3-arrows">
                    </div>
                    <div class="carausel-6-columns text-center" id="carausel-6-columns-3">



                        <% for (let i=0; i < data.length; i++) { %>
                            <div class="brand-logo">
                                <img class="img-grey-hover" src="/uploads/brand-images/<%= data[i].brandImage %>"
                                    alt="">
                            </div>
                            <% } %>




                    </div>
                </div>
            </div>
            <div class="container">
                <div class="tab-header">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                   
                        <li class="nav-item" role="presentation">
                           
                        </li>
                    </ul>
                    <a href="/shop" class="view-more d-none d-md-flex">View More<i
                            class="fi-rs-angle-double-small-right"></i></a>
                </div>
                <!--End nav-tabs-->
                <div class="tab-content wow fadeIn animated" id="myTabContent">
                    <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                        <div class="row product-grid-4">


                            <% for (let i=0; i < products.length; i++) { %>

                                <div class="col-lg-3 col-md-4 col-12 col-sm-6">
                                    <div class="product-cart-wrap mb-30">
                                        <div class="product-img-action-wrap">
                                            <div class="product-img product-img-zoom fixed-img-box">
                                                <a href="/productDetails?id=<%=products[i]._id%>">
                                                    <img class="default-img"
                                                        src="/uploads/product-images/<%=products[i].productImage[0]%>" alt="">
                                                    
                                                </a>
                                            </div>
                                            <div class="product-action-1">
                                               
                                                <a aria-label="Add To Wishlist" class="action-btn hover-up" href="javascript:void(0);" onclick="addToWishlist('<%= products[i]._id %>')"><i class="fi-rs-heart"></i></a>
                                            </div>
                                            <div class="product-badges product-badges-position product-badges-mrg">
                                                <span class="hot">New</span>
                                            </div>
                                        </div>
                                        <div class="product-content-wrap">
                                            <div class="product-brand">
                                                <a href="/productDetails?id=<%=products[i].id%>"><%-products[i].brand%></a>
                                            </div>
                                            <h2><a href="/productDetails?id=<%=products[i].id%>"><%-products[i].productName%></a></h2>
                                            <!-- <div class="rating-result" title="90%">
                                                <span>
                                                    <span>90%</span>
                                                </span>
                                            </div> -->
                                            <div class="product-price">
                                                <span>₹<%-products[i].salePrice.toLocaleString('en-IN')%> </span>
                                                <span class="old-price">₹<%-products[i].regularPrice.toLocaleString('en-IN')%></span>
                                            </div>
                                            <div class="product-action-1 show">
                                                <a aria-label="Add To Cart" onclick="addToCart('<%=products[i]._id%>')" class="action-btn hover-up" ><i class="fi-rs-shopping-bag-add"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <% } %>


                        </div>
                    </div>
                </div>
            </div>
            <!--End product-grid-4-->
            </div>
            <!--En tab three (New added)-->
            </div>
            <!--End tab-content-->
            </div>
        </section>

<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', function () {
  new Swiper('.swiper', {
    loop: true,
    autoplay: {
      delay: 5000,
      disableOnInteraction: false,
    },
    pagination: {
      el: '.swiper-pagination',
      clickable: true,
    },
    navigation: {
      nextEl: '.swiper-button-next',
      prevEl: '.swiper-button-prev',
    },
    speed: 1000,
    effect: 'slide',
  });
});
</script>

<script>
  console.log("Swiper loaded:", typeof Swiper);
</script>



<script>
function updateHeaderBadges(cartCount = null, wishlistCount = null) {
    const cartBadge = document.getElementById("cartBadge");
    const wishlistBadge = document.getElementById("wishlistBadge");

    if (cartBadge && cartCount !== null) cartBadge.textContent = cartCount;
    if (wishlistBadge && wishlistCount !== null) wishlistBadge.textContent = wishlistCount;
}

// Fetch updated counts from server
async function fetchCartWishlistCounts() {
    try {
        const res = await fetch("/api/cart-wishlist-count");
        const data = await res.json();
        updateHeaderBadges(data.cartCount, data.wishlistCount);
    } catch (err) {
        console.error("Failed to fetch cart/wishlist counts", err);
    }
}

// Add to Cart
function addToCart(prodId) {
    $.ajax({
        url: `/addToCart?id=${prodId}`,
        method: "post",
        data: { quantity: 1 },
        success: (res) => {
            if(res.status === true){
                Swal.fire({
                    title: 'Added to Cart!',
                    text: 'Continue Shopping',
                    icon: 'success',
                    timer: 1500,
                    showConfirmButton: false
                });
                fetchCartWishlistCounts(); // ✅ update badge without reload
            } else if(res.status === "Out of stock") {
                Swal.fire({ title: 'Out of Stock!', icon: 'error', timer: 1500 });
            } else {
                Swal.fire({ title: 'Login Required', icon: 'warning', timer: 1500 })
                    .then(() => window.location.href='/login');
            }
        }
    });
}

// Add to Wishlist
function addToWishlist(productId){
    $.ajax({
        url : "/addToWishlist",
        method : "post",
        data : { productId },
        success : (res)=>{
            if(res.status === true){
                Swal.fire({
                    title: 'Added to Wishlist!',
                    text: 'Continue Shopping',
                    icon: 'success',
                    timer: 1500,
                    showConfirmButton: false
                });
                fetchCartWishlistCounts(); // ✅ update badge without reload
            } else {
                Swal.fire({
                    title: 'Login Required',
                    text: 'Continue Shopping',
                    icon: 'warning',
                    timer: 1500,
                    showConfirmButton: false
                }).then(() => window.location.href='/login');
            }
        }
    })
}
</script>

        <script>
            var swiper = new Swiper('.swiper-container', {
                slidesPerView: 1,
                spaceBetween: 10,
                navigation: {
                    nextEl: '.swiper-button-next',
                    prevEl: '.swiper-button-prev',
                },
                pagination: {
                    el: '.swiper-pagination',
                    clickable: true,
                },
            });
        </script>


        <%- include("../partials/footer") %>